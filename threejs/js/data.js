var Surf = Surf || {};

Surf.Data = function(){
  this.data = '+,7204,2624,30728,-0.05,-0.02,-0.06,1503+,-3348,1266,-1840,-0.21,0.00,-0.09,1609+,-8258,98,-12752,-0.30,0.03,-0.15,1715+,-302,114,-3100,-0.28,0.01,-0.25,1822+,3270,5298,32767,-0.07,-0.02,-0.33,1928+,9714,5096,32767,0.05,-0.04,-0.42,2034+,11028,3884,32767,-0.01,-0.05,-0.46,2141+,-2398,3326,-2204,-0.19,-0.01,-0.46,2247+,-10406,-260,-14966,-0.35,0.01,-0.48,2353+,-2600,-420,-10306,-0.39,-0.02,-0.55,2459+,744,4160,14290,-0.18,-0.04,-0.63,2566+,10714,7904,32767,0.08,-0.06,-0.69,2672+,11224,4802,32767,0.08,-0.09,-0.73,2781+,6208,4376,19136,-0.06,-0.08,-0.70,2887+,-4936,1826,-7882,-0.24,-0.05,-0.68,2993+,-8284,-1180,-13880,-0.36,-0.04,-0.68,3100+,530,122,-4240,-0.32,-0.07,-0.74,3207+,3928,6868,32767,-0.03,-0.10,-0.78,3314+,11018,6220,32767,0.11,-0.11,-0.84,3420+,11210,6062,32767,0.07,-0.12,-0.86,3527+,2692,3130,6862,-0.11,-0.09,-0.83,3634+,-5180,-410,-13678,-0.28,-0.05,-0.82,3741+,-4250,-2020,-13784,-0.38,-0.06,-0.82,3847+,3112,1856,3854,-0.25,-0.10,-0.86,3954+,5146,11082,32767,0.10,-0.12,-0.91,4064+,8880,7024,32767,0.12,-0.13,-0.94,4170+,7398,4458,24370,-0.00,-0.12,-0.92,4277+,-1570,1974,-534,-0.17,-0.07,-0.90,4384+,-3006,-2514,-13084,-0.31,-0.06,-0.89,4491+,-2588,-1572,-10976,-0.35,-0.07,-0.90,4598+,176,4648,13866,-0.17,-0.08,-0.93,4704+,176,4648,13866,-0.17,-0.08,-0.93,4861+,-22816,4658,22980,-0.10,-0.19,-0.99,4968+,-26820,1828,19784,-0.11,-0.11,-0.92,5074+,-13588,-352,14836,-0.12,-0.04,-0.99,5180+,8578,-426,17274,-0.11,-0.02,-1.09,5286+,28052,-1642,16690,-0.12,-0.05,-1.18,5395+,27434,-394,12550,-0.14,-0.12,-1.16,5501+,8708,3056,14464,-0.15,-0.13,-1.05,5608+,-13148,2922,19988,-0.14,-0.11,-0.88,5714+,-29924,3752,19728,-0.15,-0.06,-0.78,5820+,-23754,3328,16556,-0.15,0.01,-0.81,5927+,-2426,2720,17360,-0.15,0.05,-0.93,6033+,23802,714,17572,-0.14,0.02,-1.08,6139+,-32768,-754,14072,-0.15,-0.07,-1.17,6245+,22936,2370,12226,-0.17,-0.13,-1.10,6352+,-5054,3598,16234,-0.16,-0.13,-0.93,6458+,-31892,3600,21038,-0.15,-0.11,-0.78,6565+,-30560,1986,18104,-0.14,-0.02,-0.78,6674+,-12458,1474,15542,-0.15,0.05,-0.87,6781+,17722,1658,17418,-0.14,0.05,-1.02,6888+,-32768,650,16642,-0.14,-0.03,-1.16,6994+,27378,2764,13356,-0.14,-0.10,-1.13,7101+,-262,2158,17248,-0.13,-0.12,-0.97,7208+,-29788,3070,18404,-0.14,-0.10,-0.80,7315+,-32767,3670,19838,-0.13,-0.01,-0.76,7422+,-9574,1150,16146,-0.14,0.05,-0.85,7528+,18666,-76,17928,-0.14,0.03,-0.99,7635+,31448,168,15272,-0.15,-0.03,-1.10,7742+,28136,1972,13616,-0.16,-0.11,-1.08,7849+,1108,2922,15666,-0.16,-0.12,-0.93,7958+,-29246,3536,20216,-0.15,-0.10,-0.75,8065+,-32767,4118,19392,-0.14,-0.02,-0.67,8172+,-32767,4118,19392,-0.14,-0.02,-0.67,8329+,6566,-4872,13364,-0.37,-0.42,-0.81,8435+,7992,-5490,13722,-0.37,-0.44,-0.82,8541+,6760,-5042,14392,-0.37,-0.44,-0.81,8648+,7148,-5280,13788,-0.38,-0.45,-0.81,8754';
  this.coordinates = [];
  this.parseData(this.data);
};

Surf.Data.prototype.parseData = function(data) {
  var rows = data.split('+');
  var prevTime = 0;
  this.coordinates = [];
  for(var i = 0; i < rows.length; i++){
    var c = new Surf.Coordinate();
    var vals = rows[i].split(',');
    var timestamp = parseInt(vals[7], 10);
    var deltaTime = timestamp - prevTime;

    // gyro data
    var rotX = parseFloat(vals[4]);
    var rotY = parseFloat(vals[5]);
    var rotZ = parseFloat(vals[6]);
    c.quat = new THREE.Quaternion().setFromEuler(new THREE.Euler(rotX, rotY, rotZ));

    // accelerometer data
    c.force = {};
    c.force.x = parseInt(vals[1], 10) / deltaTime;
    c.force.z = parseInt(vals[2], 10) / deltaTime;
    c.force.y = parseInt((parseInt(vals[3], 10)/ deltaTime), 10);

    // calculate position
    c.accel = c.force;
    c.vel.add(c.accel);
    c.loc.add(c.vel);

    this.coordinates.push(c);

    prevLoc = c.loc;
    prevTime = timestamp;
  }
};

